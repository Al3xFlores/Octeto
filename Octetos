SELECT 
  coluna1,
  coluna2,
  coluna3,
  SUBSTRING(ip_column, 1, LENGTH(ip_column) - LENGTH(SUBSTR(ip_column, INSTR(ip_column, '.', -1)))) AS first_three_octets,
  COUNT(*) OVER (PARTITION BY SUBSTRING(ip_column, 1, LENGTH(ip_column) - LENGTH(SUBSTR(ip_column, INSTR(ip_column, '.', -1))))) AS count
FROM your_table;
